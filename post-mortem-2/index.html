<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Beacon Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Beacon Docs Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Beacon Docs" href="/opensearch.xml"><title data-react-helmet="true">Postmortem Incident 2 | Beacon Docs</title><meta data-react-helmet="true" property="og:url" content="https://docs.walletbeacon.io/post-mortem-2"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Postmortem Incident 2 | Beacon Docs"><meta data-react-helmet="true" name="description" content="Date: 2022-04-12"><meta data-react-helmet="true" property="og:description" content="Date: 2022-04-12"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.walletbeacon.io/post-mortem-2"><link data-react-helmet="true" rel="alternate" href="https://docs.walletbeacon.io/post-mortem-2" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.walletbeacon.io/post-mortem-2" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.4bca38a3.css">
<link rel="preload" href="/assets/js/styles.550004cc.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.d274824c.js" as="script">
<link rel="preload" href="/assets/js/main.1b59c95d.js" as="script">
<link rel="preload" href="/assets/js/5.34a2f55f.js" as="script">
<link rel="preload" href="/assets/js/6.ac92f5ad.js" as="script">
<link rel="preload" href="/assets/js/0ce74438.9567626f.js" as="script">
<link rel="preload" href="/assets/js/72.9f7c08b6.js" as="script">
<link rel="preload" href="/assets/js/73.9c22bab3.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.19500865.js" as="script">
<link rel="preload" href="/assets/js/17896441.b8972911.js" as="script">
<link rel="preload" href="/assets/js/6600eccf.16b4c03e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-white.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link navbar__link--active" href="/getting-started/simple-example">dApps</a><a class="navbar__item navbar__link" href="/wallet/getting-started/web/getting-started">Wallets</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/playground/">Playground</a><a href="https://debug.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Debug Wallet</a><a href="https://github.com/airgap-it/beacon-sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-white.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/getting-started/simple-example">dApps</a></li><li class="menu__list-item"><a class="menu__link" href="/wallet/getting-started/web/getting-started">Wallets</a></li><li class="menu__list-item"><a class="menu__link" href="/playground/">Playground</a></li><li class="menu__list-item"><a href="https://debug.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="menu__link">Debug Wallet</a></li><li class="menu__list-item"><a href="https://github.com/airgap-it/beacon-sdk" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contributing">Contributing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/supported-wallets">Wallets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dapps">DApps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/security-audits">Security Audits</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/first-dapp">First dApp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/best-practices">Best Practices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/simple-example">Simple Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/advanced-example">Advanced Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/high-performance">High Performance</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/active-account">Active Account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/disconnecting-a-wallet">Disconnecting a Wallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/network">Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/request-permissions">Request Permissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/sign-payload">Sign Payload</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/broadcast-request">Broadcast Request</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/simple-contract-call">Simple Contract Call</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/fa1.2-transfer">FA1.2 Transfer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/fa2-transfer">FA2 Transfer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/contract-error-handling">Handling Contract Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/subscribe-to-event">Subscribe To Event</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/standalone-delegation">Standalone Delegation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/ui-elements">UI Elements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/custom-block-explorer">Custom Block Explorer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/different-node">Different Beacon Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/debug-wallet">Debug Wallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/sdk-info">Client Info</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Flows</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/flows/connection">Connection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/flows/extension-communication">Extension Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/flows/ledger-extension">Ledger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/flows/local-mnemonic">Local Mnemonic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/flows/p2p-direct">P2P Direct</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/flows/p2p-extension">P2P Extension</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Messages</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchains/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/blockchains/usage">Usage</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Blockchains</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blockchains/substrate">Substrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blockchains/tezos">Tezos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/blockchains/tezos-sapling">Tezos Sapling</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/CHANGELOG">Changelog</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Post Mortem</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/post-mortem">Postmortem Incident 1</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/post-mortem-2">Postmortem Incident 2</a></li></ul></li><li class="menu__list-item"><a href="https://typedocs.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN">TypeDoc Reference</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Postmortem Incident 2</h1></header><div class="markdown"><p><strong>Date:</strong> 2022-04-12</p><p><strong>Authors:</strong> Andreas Gassmann</p><p><strong>Status:</strong> Complete, action items in progress</p><p><strong>Summary:</strong> A security vulnerability was discovered in the beacon-sdk that would allow attackers in some circumstances to inject arbitrary Javascript into dApps.</p><p><strong>Impact:</strong> If a dApp was opened in an iFrame on a malicious website, through a hyperlink from a malicious website, or if a malicious browser extension was installed, the attacker would have been able to inject arbitrary Javascript that would be executed in the dApp context. The vulnerability only affected dApps, it did not affect wallets or the Beacon network.</p><p><strong>Root Causes:</strong> The beacon-sdk used <code>innerHTML</code> to display user provided data. The source of the user provided data was not checked, nor was the data sanitised before it was displayed. This made injection of Javascript into the website possible vis DOM based XSS (Cross Site Scripting).</p><p><strong>Resolution:</strong> Two separate mitigations were implemented:</p><ol><li>The origin of the data the SDK receives through the <code>postMessage</code> interface is now checked and messages from unsafe origins are ignored.</li><li>The UI no longer uses <code>innerHTML</code> to display data. Instead, only text is displayed, making it impossible to inject malicious Javascript.</li></ol><p><strong>Detection:</strong> The vulnerability was found by Maciej Domanski, Security Engineer at Trail of Bits, during a security review of another project. After discovering that the beacon-sdk was the cause of the issue, the Trail of Bits team privately reached out to us to disclose the vulnerabilty.</p><p><strong>Action Items:</strong></p><table><thead><tr><th>Action Item</th><th>Type</th><th>Owner</th><th>State</th></tr></thead><tbody><tr><td>Update beacon-sdk to fix vulnerability</td><td>mitigate</td><td>andreas</td><td>COMPLETE</td></tr><tr><td>Monitor dApp ecosystem and reach out to developers</td><td>mitigate</td><td>andreas</td><td>IN PROGRESS</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><ul><li>The vulnerability was found, fixed and most dApps updated in a little over a week. A huge thanks to the community for reacting quickly.</li><li>As far as we are aware, the vulnerability has not been actively exploited.</li><li>The security vulnerability only affected dApps. Wallets and the Beacon Network were not affected.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="timeline"></a>Timeline<a class="hash-link" href="#timeline" title="Direct link to heading">#</a></h2><p>(all times UTC)</p><ul><li>2022-04-05 20:30 The Trail of Bits team reached out to the Beacon team to inform us of a security vulnerability they found in the beacon-sdk during one of their audits</li><li>2022-04-05 23:00 The Beacon team was able to verify the vulnerability and started planning the fix and its rollout</li><li>2022-04-06 18:00 A proof of concept of the mitigations was implemented and fixed the security vulnerability</li><li>2022-04-07 17:00 Both mitigations were implemented and an internal review was started</li><li>2022-04-08 11:30 The fix was released to NPM with the version number <code>2.3.11</code></li><li>2022-04-08 12:00 The Beacon team started privately reaching out to dApps in the Tezos ecosystem, informing them that a new update is available and urging them to update as soon as possible</li><li>2022-04-08 18:00 A small fix was deployed to address build issues with server side rendering, beacon-sdk version <code>2.3.12</code></li><li>2022-04-11 12:00 More dApps were contacted and notified about the update</li><li>2022-04-12 23:30 The vulnerability has been posted in various developer communities</li><li>2022-04-13 15:00 The vulnerability has been publicly disclosed</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="support"></a>Support<a class="hash-link" href="#support" title="Direct link to heading">#</a></h2><p>We want to thank all the developers in the Tezos ecosystem that were involved in addressing this issue as soon as possible in a very effective manner.</p><p>Special thanks to the Trail of Bits team for reporting the vulnerability, as well as the Ecad Labs, Tezos Commons, Codecrafting Labs and Kukai Wallet teams for helping us coordinate the communication in the Tezos Developer ecosystem.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/airgap-it/beacon-docs/edit/main/src/docs/post-mortem-2.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/post-mortem"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Postmortem Incident 1</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li><li><a href="#timeline" class="table-of-contents__link">Timeline</a></li><li><a href="#support" class="table-of-contents__link">Support</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Getting Started</a></li><li class="footer__item"><a href="https://typedocs.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Typedoc Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://t.me/AirGap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://discord.gg/vuf4Gtnqh7" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/airgap_it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://medium.com/airgap-it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Beacon Components</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/airgap-it/beacon-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon SDK</a></li><li class="footer__item"><a href="https://github.com/airgap-it/beacon-android-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon Android SDK</a></li><li class="footer__item"><a href="https://github.com/airgap-it/beacon-ios-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon iOS SDK</a></li><li class="footer__item"><a href="https://github.com/airgap-it/beacon-node" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon Node</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Papers AG - Open Source MIT License</div></div></div></footer></div>
<script src="/assets/js/styles.550004cc.js"></script>
<script src="/assets/js/runtime~main.d274824c.js"></script>
<script src="/assets/js/main.1b59c95d.js"></script>
<script src="/assets/js/5.34a2f55f.js"></script>
<script src="/assets/js/6.ac92f5ad.js"></script>
<script src="/assets/js/0ce74438.9567626f.js"></script>
<script src="/assets/js/72.9f7c08b6.js"></script>
<script src="/assets/js/73.9c22bab3.js"></script>
<script src="/assets/js/935f2afb.19500865.js"></script>
<script src="/assets/js/17896441.b8972911.js"></script>
<script src="/assets/js/6600eccf.16b4c03e.js"></script>
</body>
</html>