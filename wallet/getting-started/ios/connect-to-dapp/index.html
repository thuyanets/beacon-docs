<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Beacon Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Beacon Docs Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Beacon Docs" href="/opensearch.xml"><title data-react-helmet="true">Connect to a dApp | Beacon Docs</title><meta data-react-helmet="true" property="og:url" content="https://docs.walletbeacon.io/wallet/getting-started/ios/connect-to-dapp"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Connect to a dApp | Beacon Docs"><meta data-react-helmet="true" name="description" content="Requirements"><meta data-react-helmet="true" property="og:description" content="Requirements"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.walletbeacon.io/wallet/getting-started/ios/connect-to-dapp"><link data-react-helmet="true" rel="alternate" href="https://docs.walletbeacon.io/wallet/getting-started/ios/connect-to-dapp" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.walletbeacon.io/wallet/getting-started/ios/connect-to-dapp" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.4bca38a3.css">
<link rel="preload" href="/assets/js/styles.550004cc.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.d274824c.js" as="script">
<link rel="preload" href="/assets/js/main.1b59c95d.js" as="script">
<link rel="preload" href="/assets/js/5.34a2f55f.js" as="script">
<link rel="preload" href="/assets/js/6.ac92f5ad.js" as="script">
<link rel="preload" href="/assets/js/0ce74438.9567626f.js" as="script">
<link rel="preload" href="/assets/js/72.9f7c08b6.js" as="script">
<link rel="preload" href="/assets/js/73.9c22bab3.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.19500865.js" as="script">
<link rel="preload" href="/assets/js/17896441.b8972911.js" as="script">
<link rel="preload" href="/assets/js/217fc9b0.ca19c6df.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-white.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/getting-started/simple-example">dApps</a><a class="navbar__item navbar__link navbar__link--active" href="/wallet/getting-started/web/getting-started">Wallets</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/playground/">Playground</a><a href="https://debug.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Debug Wallet</a><a href="https://github.com/airgap-it/beacon-sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-white.svg" alt="Beacon Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/getting-started/simple-example">dApps</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/wallet/getting-started/web/getting-started">Wallets</a></li><li class="menu__list-item"><a class="menu__link" href="/playground/">Playground</a></li><li class="menu__list-item"><a href="https://debug.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="menu__link">Debug Wallet</a></li><li class="menu__list-item"><a href="https://github.com/airgap-it/beacon-sdk" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/getting-started/web/getting-started">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Android</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/getting-started/android/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/getting-started/android/connect-to-dapp">Connect to a dApp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/getting-started/android/disconnect-from-dapp">Disconnect from a dApp</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">iOS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/getting-started/ios/installation">Installation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/wallet/getting-started/ios/connect-to-dapp">Connect to a dApp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/getting-started/ios/disconnect-from-dapp">Disconnect from a dApp</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Advanced</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Android</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/advanced/android/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/advanced/android/coroutines-alternatives">Coroutines Alternatives</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">iOS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/wallet/advanced/ios/configuration">Configuration</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Messages</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/messages/substrate">Substrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/messages/tezos">Tezos</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/wallet/security">Security</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Connect to a dApp</h1></header><div class="markdown"><div class="tableOfContentsInline_3fWc"><ul class="table-of-contents"><li><a href="#requirements">Requirements</a></li><li><a href="#how-to-listen-for-messages-and-respond">How to listen for messages and respond</a><ul><li><a href="#create-a-wallet-client">Create a wallet client</a></li><li><a href="#subscribe-to-incoming-requests">Subscribe to incoming requests</a></li><li><a href="#connect-to-a-dapp">Connect to a dApp</a></li><li><a href="#handle-requests-from-the-dapp">Handle requests from the dApp</a></li></ul></li><li><a href="#example-code">Example Code</a></li></ul></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="requirements"></a>Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">#</a></h2><p>Make sure you have added the following packages as your dependencies:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">BeaconCore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BeaconClientWallet</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You should have also decided which blockchains will be supported in your application and what transport layers to use to establish the communication. Make sure you have added the appropriate <a href="/wallet/getting-started/ios/installation#blockchain">Blockchain</a> and <a href="/wallet/getting-started/ios/installation#transport">Transport</a> packages as your dependencies as well.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>See the <a href="/wallet/getting-started/ios/installation">Installation</a> page for more information about the packages and how to install them.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-listen-for-messages-and-respond"></a>How to listen for messages and respond<a class="hash-link" href="#how-to-listen-for-messages-and-respond" title="Direct link to heading">#</a></h2><p>Follow the steps below to learn how to interact with a dApp. The guide assumes all blockchains and transport layers are supported.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-a-wallet-client"></a>Create a wallet client<a class="hash-link" href="#create-a-wallet-client" title="Direct link to heading">#</a></h3><p>Create a <code>Beacon.WalletClient</code> instance by providing your app&#x27;s name, registering supported blockchains and transport layers that will be used for communication.</p><p>The example below creates a new <code>Beacon.WalletClient</code> instance with default settings. See the <a href="/wallet/advanced/ios/configuration">Configuration</a> guide to learn about more advanced setups.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconCore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainSubstrate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainTezos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconClientWallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconTransportP2PMatrix</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">var beaconWallet: Beacon.WalletClient!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">do {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    Beacon.WalletClient.create(</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        with: .init(</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            name: &quot;MyApp&quot;,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            blockchains: [Substrate.factory, Tezos.factory], // set support for Substrate and Tezos blockchains</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            connections: [try Transport.P2P.Matrix.connection()] // use Matrix to communicate with the Beacon network</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    ) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        case let .success(client):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            beaconWallet = client</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} catch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Currently only one instance of <code>Beacon.WalletClient</code> should be created per application.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="subscribe-to-incoming-requests"></a>Subscribe to incoming requests<a class="hash-link" href="#subscribe-to-incoming-requests" title="Direct link to heading">#</a></h3><p>Subscribe to requests from the dApp by connecting to the Beacon network and listening to incoming requests.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconCore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainSubstrate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainTezos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconClientWallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">beaconWallet.connect { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    case .success(_):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        beaconWallet.listen(onRequest: onSubstrateRequest) // listen for Substrate requests</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        beaconWallet.listen(onRequest: onTezosRequest) // listen for Tezos requests</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func onSubstrateRequest(_ request: Result&lt;BeaconRequest&lt;Substrate&gt;, Beacon.Error&gt;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // TODO: Not yet implemented</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func onTezosRequest(_ request: Result&lt;BeaconRequest&lt;Tezos&gt;, Beacon.Error&gt;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // TODO: Not yet implemented</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="connect-to-a-dapp"></a>Connect to a dApp<a class="hash-link" href="#connect-to-a-dapp" title="Direct link to heading">#</a></h3><p>To connect to a new dApp take the pairing request (obtained from, for example, a paring QR code) and transform it to <code>Beacon.P2PPeer</code>. Next, register the new instance of <code>Beacon.P2PPeer</code> in your wallet client.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconCore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconClientWallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">// replace placeholder values with data provided in the dApp&#x27;s pairing request</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">let dApp = Beacon.P2PPeer(</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    id: &quot;id&quot;,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    name: &quot;name&quot;,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    publicKey: &quot;publicKey&quot;,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    relayServer: &quot;relayServer&quot;,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    version: &quot;version&quot;</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">// connect to a new peer</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">beaconWallet.add([.p2p(dApp)]) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        case .success(_):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(&quot;dApp connected&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="handle-requests-from-the-dapp"></a>Handle requests from the dApp<a class="hash-link" href="#handle-requests-from-the-dapp" title="Direct link to heading">#</a></h3><p>Having received a request, you can create a response and send it back to the dApp. The response should <em>always</em> be created from an incoming request. Attempting to send a response that was not created from a request awaiting answer will result in an error.</p><p>The first request your app receives from a dApp is a permission request. The example below shows how to respond to it in the most basic way. To get more information about other kinds of requests or learn more advanced use cases see the Blockchain  guides.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconCore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainSubstrate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainTezos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconClientWallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func onSubstrateRequest(_ request: Result&lt;BeaconRequest&lt;Substrate&gt;, Beacon.Error&gt;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    do {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        let request = try request.get()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        let response = try response(from: request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        beaconWallet.respond(with: response) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case .success(_):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                print(&quot;Response sent&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } catch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func response(from request: BeaconRequest&lt;Substrate&gt;) throws -&gt; BeaconResponse&lt;Substrate&gt; {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    switch request {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    case let .permission(content):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        let accounts = try content.networks.map { try substrateAccount(network: $0) }</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        return .permission(PermissionSubstrateResponse(from: content, accounts: accounts))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    case let .blockchain(blockchain):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        return .error(ErrorBeaconResponse(from: blockchain, errorType: .aborted))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func onTezosRequest(_ request: Result&lt;BeaconRequest&lt;Tezos&gt;, Beacon.Error&gt;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    do {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        let request = try request.get()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        let response = try response(from: request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        beaconWallet.respond(with: response) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case .success(_):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                print(&quot;Response sent&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } catch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func response(from request: BeaconRequest&lt;Tezos&gt;) throws -&gt; BeaconResponse&lt;Tezos&gt; {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    switch request {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    case let .permission(content):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        let account = try tezosAccount(network: content.network)</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        return .permission(PermissionTezosResponse(from: content, account: account))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    case let .blockchain(blockchain):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        return .error(ErrorBeaconResponse(from: blockchain, errorType: .aborted))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// replace placeholder values with valid data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func substrateAccount(network: Substrate.Network) throws -&gt; Substrate.Account {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    try Substrate.Account(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        publicKey: &quot;substratePublicKey&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address: &quot;substrateAddress&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        network: network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">func tezosAccount(network: Tezos.Network) throws -&gt; Tezos.Account {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    try Tezos.Network(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        publicKey: &quot;tezosPublicKey&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address: &quot;tezosAddress&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        network: network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-code"></a>Example Code<a class="hash-link" href="#example-code" title="Direct link to heading">#</a></h2><p>The following example shows how to create a simple class which connects to a dApp using <a href="https://matrix.org/" target="_blank" rel="noopener noreferrer">Matrix</a> and handles <a href="https://substrate.io/" target="_blank" rel="noopener noreferrer">Substrate</a> and <a href="https://tezos.com/" target="_blank" rel="noopener noreferrer">Tezos</a> messages based on the steps described earlier.</p><p><a href="https://github.com/airgap-it/beacon-ios-sdk" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/github/v/tag/airgap-it/beacon-ios-sdk?label=stable&amp;sort=semver" alt="stable"></a>
<a href="https://github.com/airgap-it/beacon-ios-sdk" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/github/v/tag/airgap-it/beacon-ios-sdk?color=orange&amp;include_prereleases&amp;label=latest" alt="latest"></a></p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">SPM</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">CocoaPods</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">Package.swift</div><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">dependencies: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .package(url: &quot;https://github.com/airgap-it/beacon-ios-sdk&quot;, from: &quot;x.y.z&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">],</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Or in Xcode open the <code>Add Package Dependency</code> window (as described in <a href="https://developer.apple.com/documentation/xcode/adding_package_dependencies_to_your_app" target="_blank" rel="noopener noreferrer">the official guide</a>) and enter the <code>Beacon iOS SDK</code> GitHub repository URL</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">https://github.com/airgap-it/beacon-ios-sdk</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">Podfile</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">target &#x27;MyTarget&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    use_frameworks!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pod &#x27;BeaconCore&#x27;, :git =&gt; &#x27;https://github.com/airgap-it/beacon-ios-sdk&#x27;, :tag =&gt; &#x27;x.y.z&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pod &#x27;BeaconClientWallet&#x27;, :git =&gt; &#x27;https://github.com/airgap-it/beacon-ios-sdk&#x27;, :tag =&gt; &#x27;x.y.z&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pod &#x27;BeaconBlockchainSubstrate&#x27;, :git =&gt; &#x27;https://github.com/airgap-it/beacon-ios-sdk&#x27;, :tag =&gt; &#x27;x.y.z&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pod &#x27;BeaconBlockchainTezos&#x27;, :git =&gt; &#x27;https://github.com/airgap-it/beacon-ios-sdk&#x27;, :tag =&gt; &#x27;x.y.z&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pod &#x27;BeaconTransportP2PMatrix&#x27;, :git =&gt; &#x27;https://github.com/airgap-it/beacon-ios-sdk&#x27;, :tag =&gt; &#x27;x.y.z&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></div></div><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">BeaconExample.swift</div><div class="codeBlockContent_hGly swift"><div tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import Foundation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconCore</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainSubstrate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconBlockchainTezos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconClientWallet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import BeaconTransportP2PMatrix</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class BeaconExample {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var beaconWallet: Beacon.WalletClient!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    let dApp = Beacon.P2PPeer(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id: &quot;0b02d44c-de33-b5ab-7730-ff8e62f61869&quot; /* TODO: change me */,,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name: &quot;My dApp&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        publicKey: &quot;6c7870aa1e42477fd7c2baaf4763bd826971e470772f71a0a388c1763de3ea1e&quot; /* TODO: change me */,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        relayServer: &quot;beacon-node-1.sky.papers.tech&quot; /* TODO: change me */,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        version: &quot;2&quot; /* TODO: change me */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func substrateAccount(network: Substrate.Network) throws -&gt; Substrate.Account {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        try Substrate.Account(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            publicKey: &quot;f4c6095213a2f6d09464ed882b12d6024d20f7170c3b8bd5c1b071e4b00ced72&quot; /* TODO: change me */,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address: &quot;16XwWkdUqFXFY1tJNf1Q6fGgxQnGYUS6M95wPcrbp2sjjuoC&quot; /* TODO: change me */,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            network: network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func tezosAccount(network: Tezos.Network) throws -&gt; Tezos.Account {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        try Tezos.Network(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            publicKey: &quot;9ae0875d510904b0b15d251d8def1f5f3353e9799841c0ed6d7ac718f04459a0&quot; /* TODO: change me */,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address: &quot;tz1SkbBZg15BXPRkYCrSzhY6rq4tKGtpUSWv&quot; /* TODO: change me */,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            network: network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func run() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        createBeaconWallet { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            guard case .success(_) = result else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                return</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            self.subscribeToRequests { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                guard case .success(_) = result else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    return</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                self.connectToDApp { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    guard case .success(_) = result else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        return</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func createBeaconWallet(completion: @escaping (Result&lt;(), Error&gt;) -&gt; ()) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        do {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            Beacon.WalletClient.create(</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                with: .init(</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                    name: &quot;MyApp&quot;,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                    blockchains: [Substrate.factory, Tezos.factory],</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                    connections: [try Transport.P2P.Matrix.connection()]</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                )</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            ) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case let .success(client):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    self.beaconWallet = client</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    completion(.success(()))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    completion(.failure(error))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } catch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            completion(.failure(error))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func subscribeToRequests(completion: @escaping (Result&lt;(), Error&gt;) -&gt; ()) {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        beaconWallet.connect { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case .success(_):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                self.beaconWallet.listen(onRequest: self.onSubstrateRequest)</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">                self.beaconWallet.listen(onRequest: self.onTezosRequest)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                completion(.success(()))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                completion(.failure(error))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func connectToDApp(completion: @escaping (Result&lt;(), Error&gt;) -&gt; ()) {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        beaconWallet.add([.p2p(dApp)]) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case .success(_):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                completion(.success(()))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                completion(.failure(error))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func onSubstrateRequest(_ request: Result&lt;BeaconRequest&lt;Substrate&gt;, Beacon.Error&gt;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        do {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let request = try request.get()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let response = try response(from: request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            beaconWallet.respond(with: response) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case .success(_):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    print(&quot;Response sent&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } catch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func response(from request: BeaconRequest&lt;Substrate&gt;) throws -&gt; BeaconResponse&lt;Substrate&gt; {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        switch request {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        case let .permission(content):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            let accounts = try content.networks.map { try substrateAccount(network: $0) }</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            return .permission(PermissionSubstrateResponse(from: content, accounts: accounts))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        case let .blockchain(blockchain):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            return .error(ErrorBeaconResponse(from: blockchain, errorType: .aborted))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func onTezosRequest(_ request: Result&lt;BeaconRequest&lt;Tezos&gt;, Beacon.Error&gt;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        do {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let request = try request.get()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            let response = try response(from: request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            beaconWallet.respond(with: response) { result in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                switch result {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case .success(_):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    print(&quot;Response sent&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                case let .failure(error):</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        } catch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(error)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    func response(from request: BeaconRequest&lt;Tezos&gt;) throws -&gt; BeaconResponse&lt;Tezos&gt; {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        switch request {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        case let .permission(content):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            let account = try tezosAccount(network: content.network)</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            return .permission(PermissionTezosResponse(from: content, account: account))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        case let .blockchain(blockchain):</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">            return .error(ErrorBeaconResponse(from: blockchain, errorType: .aborted))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/airgap-it/beacon-docs/edit/main/src/docs/wallet/getting-started/ios/connect-to-dapp.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/wallet/getting-started/ios/installation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/wallet/getting-started/ios/disconnect-from-dapp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Disconnect from a dApp Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link">Requirements</a></li><li><a href="#how-to-listen-for-messages-and-respond" class="table-of-contents__link">How to listen for messages and respond</a><ul><li><a href="#create-a-wallet-client" class="table-of-contents__link">Create a wallet client</a></li><li><a href="#subscribe-to-incoming-requests" class="table-of-contents__link">Subscribe to incoming requests</a></li><li><a href="#connect-to-a-dapp" class="table-of-contents__link">Connect to a dApp</a></li><li><a href="#handle-requests-from-the-dapp" class="table-of-contents__link">Handle requests from the dApp</a></li></ul></li><li><a href="#example-code" class="table-of-contents__link">Example Code</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Getting Started</a></li><li class="footer__item"><a href="https://typedocs.walletbeacon.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Typedoc Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://t.me/AirGap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://discord.gg/vuf4Gtnqh7" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/airgap_it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://medium.com/airgap-it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Beacon Components</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/airgap-it/beacon-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon SDK</a></li><li class="footer__item"><a href="https://github.com/airgap-it/beacon-android-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon Android SDK</a></li><li class="footer__item"><a href="https://github.com/airgap-it/beacon-ios-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon iOS SDK</a></li><li class="footer__item"><a href="https://github.com/airgap-it/beacon-node" target="_blank" rel="noopener noreferrer" class="footer__link-item">Beacon Node</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Papers AG - Open Source MIT License</div></div></div></footer></div>
<script src="/assets/js/styles.550004cc.js"></script>
<script src="/assets/js/runtime~main.d274824c.js"></script>
<script src="/assets/js/main.1b59c95d.js"></script>
<script src="/assets/js/5.34a2f55f.js"></script>
<script src="/assets/js/6.ac92f5ad.js"></script>
<script src="/assets/js/0ce74438.9567626f.js"></script>
<script src="/assets/js/72.9f7c08b6.js"></script>
<script src="/assets/js/73.9c22bab3.js"></script>
<script src="/assets/js/935f2afb.19500865.js"></script>
<script src="/assets/js/17896441.b8972911.js"></script>
<script src="/assets/js/217fc9b0.ca19c6df.js"></script>
</body>
</html>