(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{104:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return u}));var o=n(3),a=n(7),r=(n(0),n(213)),i=(n(229),n(230),{title:"High Performance"}),c={unversionedId:"getting-started/high-performance",id:"getting-started/high-performance",isDocsHomePage:!1,title:"High Performance",description:"There are a few best practices dApp developers can follow to make their dApps more performant. We will go into a few of those here. Which ones are relevant to your dApp is always depending on the type of dApp. If you need help, feel free to reach out to us on Discord in the #beacon channel.",source:"@site/docs/getting-started/high-performance.mdx",slug:"/getting-started/high-performance",permalink:"/getting-started/high-performance",editUrl:"https://github.com/airgap-it/beacon-docs/edit/main/src/docs/getting-started/high-performance.mdx",version:"current",sidebar:"docs",previous:{title:"Advanced Example",permalink:"/getting-started/advanced-example"},next:{title:"Active Account",permalink:"/guides/active-account"}},s=[{value:"Make sure beacon-sdk is up to date",id:"make-sure-beacon-sdk-is-up-to-date",children:[]},{value:"Reusing connected accounts",id:"reusing-connected-accounts",children:[]},{value:"Connect to multiple RPCs",id:"connect-to-multiple-rpcs",children:[]},{value:"Allow users to connect their Wallet early on",id:"allow-users-to-connect-their-wallet-early-on",children:[]},{value:"Reduce number of requests made to RPCs",id:"reduce-number-of-requests-made-to-rpcs",children:[{value:"Use beacon without taquito",id:"use-beacon-without-taquito",children:[]},{value:"Use Caching with taquito",id:"use-caching-with-taquito",children:[]}]},{value:"Provide fee and gas estimates",id:"provide-fee-and-gas-estimates",children:[]},{value:"Check Beacon Network Status",id:"check-beacon-network-status",children:[]},{value:"Reach out to the Beacon Team",id:"reach-out-to-the-beacon-team",children:[]}],l={toc:s};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(o.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"There are a few best practices dApp developers can follow to make their dApps more performant. We will go into a few of those here. Which ones are relevant to your dApp is always depending on the type of dApp. If you need help, feel free to reach out to us on ",Object(r.b)("a",{parentName:"p",href:"https://discord.gg/vuf4Gtnqh7"},"Discord")," in the #beacon channel."),Object(r.b)("h2",{id:"make-sure-beacon-sdk-is-up-to-date"},"Make sure beacon-sdk is up to date"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"beacon-sdk")," receives frequent updates with small bugfixes and performance improvements. We keep breaking changes to a minimum, so updating is usually as easy as increasing the version number."),Object(r.b)("h2",{id:"reusing-connected-accounts"},"Reusing connected accounts"),Object(r.b)("p",null,"This one is a basic concept of Beacon, but still very important."),Object(r.b)("p",null,'Every time a user connects their wallet and shares permission to use an account, that account is persisted on the dApp side. At this point, the UI should reflect that the user is connected and display the address that was shared. The "Connect" or "Sync" button should be replaced by a "Disconnect" or "Unsync" button. Even when the user refreshes, the account is still present and can be retrieved by calling ',Object(r.b)("inlineCode",{parentName:"p"},"dAppClient.getActiveAccount()"),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'import { DAppClient } from "@airgap/beacon-sdk";\n\nconst dAppClient = new DAppClient({ name: "Beacon Docs" });\n\n// The following code should always be run during pageload if you want to show if the user is connected.\nconst activeAccount = await dAppClient.getActiveAccount();\nif (activeAccount) {\n  // User already has account connected, everything is ready\n  // You can now do an operation request, sign request, or send another permission request to switch wallet\n  console.log("Already connected:", activeAccount.address);\n  return activeAccount;\n} else {\n  // The user is not connected. A button should be displayed where the user can connect to his wallet.\n  console.log("Not connected!");\n}\n')),Object(r.b)("h2",{id:"connect-to-multiple-rpcs"},"Connect to multiple RPCs"),Object(r.b)("p",null,"If a high number of users are using your dApp at the same time, the load on the RPC can spike. Ideally, the server infrastructure should be using a load balancer and caching to handle the load. If no such infrastructure is available, it is a good idea to provide an array of nodes and randomly select one on pageload. In case one of the nodes goes down, a user can connect to a different one by refreshing."),Object(r.b)("p",null,"An even better approach is to add a node selection to your dApp, including a way for users to provide their own RPC."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'import { TezosToolkit } from "@taquito/taquito";\nimport { BeaconWallet } from "@taquito/beacon-wallet";\n\n// Define an array of nodes\nconst RPCs = [\n  "https://mainnet-tezos.giganode.io",\n  "https://mainnet.api.tez.ie",\n];\n\n// Select random node from array\nconst randomRpc = RPCs[Math.floor(RPCs.length * Math.random())];\n\nconst Tezos = new TezosToolkit(randomRpc);\nconst wallet = new BeaconWallet({ name: "Beacon Docs" }); // Takes the same arguments as the DAppClient constructor\n\nTezos.setWalletProvider(wallet);\n')),Object(r.b)("h2",{id:"allow-users-to-connect-their-wallet-early-on"},"Allow users to connect their Wallet early on"),Object(r.b)("p",null,"In case your dApp is focussed around a specific time (eg. NFT drop or a countdown of some sorts), you should already provide a way for users to pair their wallet with the dApp. This will reduce the load on the Beacon Network once the countdown hits 0."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'import { DAppClient } from "@airgap/beacon-sdk";\n\nconst dAppClient = new DAppClient({ name: "Beacon Docs" });\n\ntry {\n  console.log("Requesting permissions...");\n  const permissions = await dAppClient.requestPermissions();\n  console.log("Got permissions:", permissions.address);\n} catch (error) {\n  console.log("Got error:", error);\n}\n')),Object(r.b)("h2",{id:"reduce-number-of-requests-made-to-rpcs"},"Reduce number of requests made to RPCs"),Object(r.b)("p",null,"Whenever doing a call in taquito, it internally has to fetch data from the chain. Under normal circumstances, those requests are not a big deal. But if a high number of users are using your dApp at the same time, those requests can become a problem for the RPCs."),Object(r.b)("h3",{id:"use-beacon-without-taquito"},"Use beacon without taquito"),Object(r.b)("p",null,"When the ",Object(r.b)("inlineCode",{parentName:"p"},"beacon-sdk")," is used without taquito, no connection to any RPC is required. So if your dApp offers only simple functionality (eg. only calling the ",Object(r.b)("inlineCode",{parentName:"p"},"mint")," entrypoint with one parameter), it is more performant to construct the contract call yourself and send it to the Beacon Network direcly, without going through taquito first."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'const result = await dAppClient.requestOperation({\n  operationDetails: [\n    {\n      kind: TezosOperationType.TRANSACTION,\n      amount: "0",\n      destination: NFT_CONTRACT,\n      parameters: {\n        entrypoint: "mint",\n        value: {\n          int: 3,\n        },\n      },\n    },\n  ],\n});\n')),Object(r.b)("p",null,"See a full example ",Object(r.b)("a",{parentName:"p",href:"/guides/simple-contract-call"},"here")),Object(r.b)("h3",{id:"use-caching-with-taquito"},"Use Caching with taquito"),Object(r.b)("p",null,"Taquito offers a couple of optional features to reduce the number of network requests."),Object(r.b)("h4",{id:"enable-caching"},"Enable caching"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'import { TezosToolkit } from "@taquito/taquito";\nimport { RpcClient, RpcClientCache } from "@taquito/rpc";\n\nconst rpc = new RpcClientCache(new RpcClient(RPC_URL));\nthis.tezos = new TezosToolkit(rpc);\n')),Object(r.b)("p",null,"More information in the official ",Object(r.b)("a",{parentName:"p",href:"https://tezostaquito.io/docs/rpc-cache"},"Taquito RPC Caching Docs")),Object(r.b)("h4",{id:"provide-contract-data-locally"},"Provide contract data locally"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'import { TezosToolkit } from "@taquito/taquito";\nimport { ContractsLibrary } from "@taquito/contracts-library";\n\nconst contractsLibrary = new ContractsLibrary();\n\nconst contractInfo = {}; // A JSON file of the contract data.\ncontractsLibrary.addContract(contractInfo);\n\nconst Tezos = new TezosToolkit(RPC_URL);\nTezos.addExtension(contractsLibrary);\n')),Object(r.b)("p",null,"More information in the official ",Object(r.b)("a",{parentName:"p",href:"https://tezostaquito.io/docs/contracts-library"},"Taquito Contracts Library Docs")),Object(r.b)("h4",{id:"local-packing"},"Local Packing"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'import { TezosToolkit } from "@taquito/taquito";\nimport { MichelCodecPacker } from "@taquito/taquito";\n\nconst Tezos = new TezosToolkit(RPC_URL);\nTezos.setPackerProvider(new MichelCodecPacker());\n')),Object(r.b)("p",null,"More information in the official ",Object(r.b)("a",{parentName:"p",href:"https://tezostaquito.io/docs/maps_bigmaps/#local-packing-for-big-maps"},"Taquito Local Packing Docs")),Object(r.b)("h2",{id:"provide-fee-and-gas-estimates"},"Provide fee and gas estimates"),Object(r.b)("p",null,"Depending on the contract that is used on your dApp, the ",Object(r.b)("inlineCode",{parentName:"p"},"storage_limit")," or ",Object(r.b)("inlineCode",{parentName:"p"},"gas_limit")," can change with each contract call. This means if multiple people are interacting with the contract in the same block, it is possible that operations will fail because the previously estimated values are no longer correct."),Object(r.b)("p",null,"The contract developer should be able to give rough estimates of what the ",Object(r.b)("inlineCode",{parentName:"p"},"storage_limit")," and ",Object(r.b)("inlineCode",{parentName:"p"},"gas_limit")," should be. If they change frequently, the dApp should provide a preset for those parameters. Beacon will send those presets to the Wallet, which will take them into consideration when preparing the operation."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-ts"},'const result = await dAppClient.requestOperation({\n  operationDetails: [\n    {\n      kind: TezosOperationType.TRANSACTION,\n      amount: "1",\n      destination: recipientAddress,\n      fee: "10000", // Set this depending on your contract\n      gas_limit: "10000", // Set this depending on your contract\n      storage_limit: "1000", // Set this depending on your contract\n    },\n  ],\n});\n')),Object(r.b)("h2",{id:"check-beacon-network-status"},"Check Beacon Network Status"),Object(r.b)("p",null,"You can check the performance of the Beacon Network here in our ",Object(r.b)("a",{parentName:"p",href:"https://status.walletbeacon.io"},"Dashboard"),". If you see spikes, it is possible that performance is affected. Usually, the network recovers once the load reduces."),Object(r.b)("div",{className:"admonition admonition-info alert alert--info"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"When using Browser Extension wallets (eg. Temple or Spire), the status of the Beacon Network does ",Object(r.b)("strong",{parentName:"p"},"NOT")," affect the connection to the wallet. If something doesn't work in conjunction with Temple or Spire, it is most likely the RPC of the dApp or Wallet."))),Object(r.b)("h2",{id:"reach-out-to-the-beacon-team"},"Reach out to the Beacon Team"),Object(r.b)("p",null,"If you have any questions or doubts about the integration of Beacon on your dApp, feel free to reach out to us on ",Object(r.b)("a",{parentName:"p",href:"https://discord.gg/vuf4Gtnqh7"},"Discord")," in the #beacon channel. If are developing a dApp with a scheduled event, please contact us in advance so we have enough time to help you prepare for the release."))}u.isMDXComponent=!0},213:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var o=n(0),a=n.n(o);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),u=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=u(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},h=a.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=o,b=p["".concat(i,".").concat(h)]||p[h]||d[h]||r;return n?a.a.createElement(b,c(c({ref:t},l),{},{components:n})):a.a.createElement(b,c({ref:t},l))}));function b(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=h;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,i[1]=c;for(var l=2;l<r;l++)i[l]=n[l];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},219:function(e,t,n){"use strict";function o(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=o(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}t.a=function(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=o(e))&&(a&&(a+=" "),a+=t);return a}},229:function(e,t,n){"use strict";var o=n(0),a=n.n(o),r=n(234),i=n(219),c=n(57),s=n.n(c);var l=37,u=39;t.a=function(e){var t=e.lazy,n=e.block,c=e.defaultValue,p=e.values,d=e.groupId,h=e.className,b=Object(r.a)(),m=b.tabGroupChoices,f=b.setTabGroupChoices,g=Object(o.useState)(c),v=g[0],y=g[1],w=o.Children.toArray(e.children),O=[];if(null!=d){var j=m[d];null!=j&&j!==v&&p.some((function(e){return e.value===j}))&&y(j)}var C=function(e){var t=e.target,n=O.indexOf(t),o=w[n].props.value;y(o),null!=d&&(f(d,o),setTimeout((function(){var e,n,o,a,r,i,c,l;(e=t.getBoundingClientRect(),n=e.top,o=e.left,a=e.bottom,r=e.right,i=window,c=i.innerHeight,l=i.innerWidth,n>=0&&r<=l&&a<=c&&o>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(s.a.tabItemActive),setTimeout((function(){return t.classList.remove(s.a.tabItemActive)}),2e3))}),150))},k=function(e){var t,n;switch(e.keyCode){case u:var o=O.indexOf(e.target)+1;n=O[o]||O[0];break;case l:var a=O.indexOf(e.target)-1;n=O[a]||O[O.length-1]}null===(t=n)||void 0===t||t.focus()};return a.a.createElement("div",{className:"tabs-container"},a.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(i.a)("tabs",{"tabs--block":n},h)},p.map((function(e){var t=e.value,n=e.label;return a.a.createElement("li",{role:"tab",tabIndex:v===t?0:-1,"aria-selected":v===t,className:Object(i.a)("tabs__item",s.a.tabItem,{"tabs__item--active":v===t}),key:t,ref:function(e){return O.push(e)},onKeyDown:k,onFocus:C,onClick:C},n)}))),t?Object(o.cloneElement)(w.filter((function(e){return e.props.value===v}))[0],{className:"margin-vert--md"}):a.a.createElement("div",{className:"margin-vert--md"},w.map((function(e,t){return Object(o.cloneElement)(e,{key:t,hidden:e.props.value!==v})}))))}},230:function(e,t,n){"use strict";var o=n(0),a=n.n(o);t.a=function(e){var t=e.children,n=e.hidden,o=e.className;return a.a.createElement("div",{role:"tabpanel",hidden:n,className:o},t)}},234:function(e,t,n){"use strict";var o=n(0),a=n(251);t.a=function(){var e=Object(o.useContext)(a.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},251:function(e,t,n){"use strict";var o=n(0),a=Object(o.createContext)(void 0);t.a=a}}]);