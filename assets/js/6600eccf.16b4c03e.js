(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{111:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return b}));var a=n(3),r=n(7),i=(n(0),n(213)),o={title:"Postmortem Incident 2",slug:"/post-mortem-2"},l={unversionedId:"post-mortem-2",id:"post-mortem-2",isDocsHomePage:!1,title:"Postmortem Incident 2",description:"Date: 2022-04-12",source:"@site/docs/post-mortem-2.md",slug:"/post-mortem-2",permalink:"/post-mortem-2",editUrl:"https://github.com/airgap-it/beacon-docs/edit/main/src/docs/post-mortem-2.md",version:"current",sidebar:"docs",previous:{title:"Postmortem Incident 1",permalink:"/post-mortem"}},s=[{value:"Conclusion",id:"conclusion",children:[]},{value:"Timeline",id:"timeline",children:[]},{value:"Support",id:"support",children:[]}],c={toc:s};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Date:")," 2022-04-12"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Authors:")," Andreas Gassmann"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Status:")," Complete, action items in progress"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Summary:")," A security vulnerability was discovered in the beacon-sdk that would allow attackers in some circumstances to inject arbitrary Javascript into dApps."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Impact:")," If a dApp was opened in an iFrame on a malicious website, through a hyperlink from a malicious website, or if a malicious browser extension was installed, the attacker would have been able to inject arbitrary Javascript that would be executed in the dApp context. The vulnerability only affected dApps, it did not affect wallets or the Beacon network."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Root Causes:")," The beacon-sdk used ",Object(i.b)("inlineCode",{parentName:"p"},"innerHTML")," to display user provided data. The source of the user provided data was not checked, nor was the data sanitised before it was displayed. This made injection of Javascript into the website possible vis DOM based XSS (Cross Site Scripting)."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Resolution:")," Two separate mitigations were implemented:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"The origin of the data the SDK receives through the ",Object(i.b)("inlineCode",{parentName:"li"},"postMessage")," interface is now checked and messages from unsafe origins are ignored."),Object(i.b)("li",{parentName:"ol"},"The UI no longer uses ",Object(i.b)("inlineCode",{parentName:"li"},"innerHTML")," to display data. Instead, only text is displayed, making it impossible to inject malicious Javascript.")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Detection:")," The vulnerability was found by Maciej Domanski, Security Engineer at Trail of Bits, during a security review of another project. After discovering that the beacon-sdk was the cause of the issue, the Trail of Bits team privately reached out to us to disclose the vulnerabilty."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Action Items:")),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",{parentName:"tr",align:null},"Action Item"),Object(i.b)("th",{parentName:"tr",align:null},"Type"),Object(i.b)("th",{parentName:"tr",align:null},"Owner"),Object(i.b)("th",{parentName:"tr",align:null},"State"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:null},"Update beacon-sdk to fix vulnerability"),Object(i.b)("td",{parentName:"tr",align:null},"mitigate"),Object(i.b)("td",{parentName:"tr",align:null},"andreas"),Object(i.b)("td",{parentName:"tr",align:null},"COMPLETE")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:null},"Monitor dApp ecosystem and reach out to developers"),Object(i.b)("td",{parentName:"tr",align:null},"mitigate"),Object(i.b)("td",{parentName:"tr",align:null},"andreas"),Object(i.b)("td",{parentName:"tr",align:null},"IN PROGRESS")))),Object(i.b)("h2",{id:"conclusion"},"Conclusion"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"The vulnerability was found, fixed and most dApps updated in a little over a week. A huge thanks to the community for reacting quickly."),Object(i.b)("li",{parentName:"ul"},"As far as we are aware, the vulnerability has not been actively exploited."),Object(i.b)("li",{parentName:"ul"},"The security vulnerability only affected dApps. Wallets and the Beacon Network were not affected.")),Object(i.b)("h2",{id:"timeline"},"Timeline"),Object(i.b)("p",null,"(all times UTC)"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"2022-04-05 20:30 The Trail of Bits team reached out to the Beacon team to inform us of a security vulnerability they found in the beacon-sdk during one of their audits"),Object(i.b)("li",{parentName:"ul"},"2022-04-05 23:00 The Beacon team was able to verify the vulnerability and started planning the fix and its rollout"),Object(i.b)("li",{parentName:"ul"},"2022-04-06 18:00 A proof of concept of the mitigations was implemented and fixed the security vulnerability"),Object(i.b)("li",{parentName:"ul"},"2022-04-07 17:00 Both mitigations were implemented and an internal review was started"),Object(i.b)("li",{parentName:"ul"},"2022-04-08 11:30 The fix was released to NPM with the version number ",Object(i.b)("inlineCode",{parentName:"li"},"2.3.11")),Object(i.b)("li",{parentName:"ul"},"2022-04-08 12:00 The Beacon team started privately reaching out to dApps in the Tezos ecosystem, informing them that a new update is available and urging them to update as soon as possible"),Object(i.b)("li",{parentName:"ul"},"2022-04-08 18:00 A small fix was deployed to address build issues with server side rendering, beacon-sdk version ",Object(i.b)("inlineCode",{parentName:"li"},"2.3.12")),Object(i.b)("li",{parentName:"ul"},"2022-04-11 12:00 More dApps were contacted and notified about the update"),Object(i.b)("li",{parentName:"ul"},"2022-04-12 23:30 The vulnerability has been posted in various developer communities"),Object(i.b)("li",{parentName:"ul"},"2022-04-13 15:00 The vulnerability has been publicly disclosed")),Object(i.b)("h2",{id:"support"},"Support"),Object(i.b)("p",null,"We want to thank all the developers in the Tezos ecosystem that were involved in addressing this issue as soon as possible in a very effective manner."),Object(i.b)("p",null,"Special thanks to the Trail of Bits team for reporting the vulnerability, as well as the Ecad Labs, Tezos Commons, Codecrafting Labs and Kukai Wallet teams for helping us coordinate the communication in the Tezos Developer ecosystem."))}b.isMDXComponent=!0},213:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),b=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=b(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=b(n),d=a,m=p["".concat(o,".").concat(d)]||p[d]||u[d]||i;return n?r.a.createElement(m,l(l({ref:t},c),{},{components:n})):r.a.createElement(m,l({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);